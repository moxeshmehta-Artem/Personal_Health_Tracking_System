<div class="card">
  <h2>Dietitian Dashboard</h2>
  <p>Welcome, Doctor. Here are your patients.</p>

  <p-table [value]="patients" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template pTemplate="header">
      <tr>
        <th>Patient Name</th>
        <th>Age</th>
        <th>Email</th>
        <th>Doctor's Notes</th>
        <th>Action</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-patient>
      <tr>
        <td>{{ patient.firstname }} {{ patient.lastname }}</td>
        <td>{{ patient.age }}</td>
        <td>{{ patient.email }}</td>
        <td>
          <span *ngIf="patient.notes" class="text-green-600 font-bold">Has Script</span>
          <span *ngIf="!patient.notes" class="text-gray-500">None</span>
        </td>
        <td>
          <p-button label="Consult/Note" icon="pi pi-file-edit" (click)="openNoteDialog(patient)"></p-button>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-dialog header="Consultation Notes" [(visible)]="displayNoteDialog" [style]="{width: '50vw'}" [modal]="true">
    <div class="flex flex-column gap-3" *ngIf="selectedPatient">
      <p><strong>Patient:</strong> {{ selectedPatient.firstname }} {{ selectedPatient.lastname }}</p>
      <div class="field">
        <label for="notes" class="block mb-2">Prescription / Notes</label>
        <textarea rows="5" pInputTextarea [(ngModel)]="noteContent" class="w-full"></textarea>
      </div>
      <p-button label="Save Notes" (click)="saveNote()"></p-button>
    </div>
  </p-dialog>
</div>